# Funktion: Erstellt ein WebFilter Profil mit dem Namen webf_bube_v1.x => Es ist aktiv, aber blockt nur die absolut schlimmsten dinge....
# Muss noch in den jeweiligen Firewall Policy aktiviert werden

###########################
# WebFilter Settings Content Header
###########################

config webfilter content-header
    edit 1
        set name "exempt-antivirus-scanning"
        set comment "exempt from antivirus scanning"
        config entries
            edit "video\\/.*"
                set action exempt
            next
            edit "audio\\/.*"
                set action exempt
            next
        end
    next
end

###########################
# WebFilter Proxy Settings Profile v1.4
###########################
config webfilter profile
    edit "webf_bube_proxy_v1.4"
        set comment "Burkhalter IT Default Webfilter Proxy"
        set feature-set proxy
        config web
            set urlfilter-table 1
            set content-header-list 1
            set blacklist enable
            set log-search enable
        end
        config ftgd-wf
            set options error-allow rate-server-ip
            config filters
                edit 1
                    set category 2
                    set action monitor
                next
                edit 2
                    set category 7
                    set action monitor
                next
                edit 3
                    set category 8
                    set action monitor
                next
                edit 4
                    set category 9
                    set action monitor
                next
                edit 5
                    set category 11
                    set action monitor
                next
                edit 6
                    set category 12
                    set action block
                next
                edit 7
                    set category 13
                    set action monitor
                next
                edit 8
                    set category 14
                    set action block
                next
                edit 9
                    set category 15
                    set action monitor
                next
                edit 10
                    set category 16
                    set action monitor
                next
                edit 11
                    set action monitor
                next
                edit 12
                    set category 57
                    set action monitor
                next
                edit 13
                    set category 63
                    set action monitor
                next
                edit 14
                    set category 64
                    set action monitor
                next
                edit 15
                    set category 65
                    set action monitor
                next
                edit 16
                    set category 66
                    set action monitor
                next
                edit 17
                    set category 67
                    set action monitor
                next
                edit 18
                    set category 26
                    set action block
                next
                edit 19
                    set category 61
                    set action block
                next
                edit 20
                    set category 86
                    set action block
                next
                edit 21
                    set category 88
                    set action monitor
                next
                edit 22
                    set category 140
                    set action monitor
                next
                edit 23
                    set category 141
                    set action monitor
                next
                edit 24
                    set category 83
                    set action block
                next
                edit 25
                    set category 5
                    set action block
                next
                edit 26
                    set category 1
                    set action monitor
                next
                edit 27
                    set category 6
                    set action block
                next
                edit 28
                    set category 3
                    set action block
                next
                edit 29
                    set category 4
                    set action block
                next
                edit 30
                    set category 62
                    set action monitor
                next
                edit 31
                    set category 59
                    set action monitor
                next
                edit 32
                    set category 24
                    set action monitor
                next
                edit 33
                    set category 19
                    set action monitor
                next
                edit 34
                    set category 75
                    set action monitor
                next
                edit 35
                    set category 76
                    set action monitor
                next
                edit 36
                    set category 72
                    set action monitor
                next
                edit 37
                    set category 25
                    set action monitor
                next
                edit 38
                    set category 17
                    set action monitor
                next
                edit 39
                    set category 29
                    set action monitor
                next
                edit 40
                    set category 89
                    set action monitor
                next
                edit 41
                    set category 18
                    set action monitor
                next
                edit 42
                    set category 77
                    set action monitor
                next
                edit 43
                    set category 82
                    set action monitor
                next
                edit 44
                    set category 71
                    set action monitor
                next
                edit 45
                    set category 85
                    set action monitor
                next
                edit 46
                    set category 54
                    set action monitor
                next
                edit 47
                    set category 30
                    set action monitor
                next
                edit 48
                    set category 28
                    set action monitor
                next
                edit 49
                    set category 58
                    set action monitor
                next
                edit 50
                    set category 20
                    set action monitor
                next
                edit 51
                    set category 40
                    set action monitor
                next
                edit 52
                    set category 33
                    set action monitor
                next
                edit 53
                    set category 69
                    set action monitor
                next
                edit 54
                    set category 34
                    set action monitor
                next
                edit 55
                    set category 55
                    set action monitor
                next
                edit 56
                    set category 35
                    set action monitor
                next
                edit 57
                    set category 36
                    set action monitor
                next
                edit 58
                    set category 70
                    set action monitor
                next
                edit 59
                    set category 87
                    set action monitor
                next
                edit 60
                    set category 48
                    set action monitor
                next
                edit 61
                    set category 80
                    set action monitor
                next
                edit 62
                    set category 38
                    set action monitor
                next
                edit 63
                    set category 78
                    set action monitor
                next
                edit 64
                    set category 39
                    set action monitor
                next
                edit 65
                    set category 79
                    set action monitor
                next
                edit 66
                    set category 42
                    set action monitor
                next
                edit 67
                    set category 37
                    set action monitor
                next
                edit 68
                    set category 44
                    set action monitor
                next
                edit 69
                    set category 46
                    set action monitor
                next
                edit 70
                    set category 47
                    set action monitor
                next
                edit 71
                    set category 68
                    set action monitor
                next
                edit 72
                    set category 23
                    set action monitor
                next
                edit 73
                    set category 53
                    set action monitor
                next
                edit 74
                    set category 49
                    set action monitor
                next
                edit 75
                    set category 92
                    set action monitor
                next
                edit 76
                    set category 31
                    set action monitor
                next
                edit 77
                    set category 43
                    set action monitor
                next
                edit 78
                    set category 51
                    set action monitor
                next
                edit 79
                    set category 52
                    set action monitor
                next
                edit 80
                    set category 50
                    set action monitor
                next
                edit 81
                    set category 95
                    set action monitor
                next
                edit 82
                    set category 93
                    set action monitor
                next
                edit 83
                    set category 41
                    set action monitor
                next
                edit 84
                    set category 81
                    set action monitor
                next
                edit 85
                    set category 94
                    set action monitor
                next
                edit 86
                    set category 56
                    set action monitor
                next
                edit 87
                    set category 84
                    set action monitor
                next
                edit 88
                    set category 90
                    set action monitor
                next
                edit 89
                    set category 91
                    set action monitor
                next
            end
        end
    next
end


###########################
# WebFilter Flow Settings Profile v1.4
###########################
config webfilter profile
    edit "webf_bube_flow_v1.4"
        set comment "Burkhalter IT Default Webfilter flow"
        set feature-set flow
        config web
            set urlfilter-table 2
            set content-header-list 1
            set blacklist enable
        end
        config ftgd-wf
            set options error-allow rate-server-ip
            config filters
                edit 1
                    set category 2
                    set action monitor
                next
                edit 2
                    set category 7
                    set action monitor
                next
                edit 3
                    set category 8
                    set action monitor
                next
                edit 4
                    set category 9
                    set action monitor
                next
                edit 5
                    set category 11
                    set action monitor
                next
                edit 6
                    set category 12
                    set action block
                next
                edit 7
                    set category 13
                    set action monitor
                next
                edit 8
                    set category 14
                    set action block
                next
                edit 9
                    set category 15
                    set action monitor
                next
                edit 10
                    set category 16
                    set action monitor
                next
                edit 11
                    set action monitor
                next
                edit 12
                    set category 57
                    set action monitor
                next
                edit 13
                    set category 63
                    set action monitor
                next
                edit 14
                    set category 64
                    set action monitor
                next
                edit 15
                    set category 65
                    set action monitor
                next
                edit 16
                    set category 66
                    set action monitor
                next
                edit 17
                    set category 67
                    set action monitor
                next
                edit 18
                    set category 26
                    set action block
                next
                edit 19
                    set category 61
                    set action block
                next
                edit 20
                    set category 86
                    set action block
                next
                edit 21
                    set category 88
                    set action monitor
                next
                edit 22
                    set category 140
                    set action monitor
                next
                edit 23
                    set category 141
                    set action monitor
                next
                edit 24
                    set category 83
                    set action block
                next
                edit 25
                    set category 5
                    set action block
                next
                edit 26
                    set category 1
                    set action monitor
                next
                edit 27
                    set category 6
                    set action block
                next
                edit 28
                    set category 3
                    set action block
                next
                edit 29
                    set category 4
                    set action block
                next
                edit 30
                    set category 62
                    set action monitor
                next
                edit 31
                    set category 59
                    set action monitor
                next
                edit 32
                    set category 24
                    set action monitor
                next
                edit 33
                    set category 19
                    set action monitor
                next
                edit 34
                    set category 75
                    set action monitor
                next
                edit 35
                    set category 76
                    set action monitor
                next
                edit 36
                    set category 72
                    set action monitor
                next
                edit 37
                    set category 25
                    set action monitor
                next
                edit 38
                    set category 17
                    set action monitor
                next
                edit 39
                    set category 29
                    set action monitor
                next
                edit 40
                    set category 89
                    set action monitor
                next
                edit 41
                    set category 18
                    set action monitor
                next
                edit 42
                    set category 77
                    set action monitor
                next
                edit 43
                    set category 82
                    set action monitor
                next
                edit 44
                    set category 71
                    set action monitor
                next
                edit 45
                    set category 85
                    set action monitor
                next
                edit 46
                    set category 54
                    set action monitor
                next
                edit 47
                    set category 30
                    set action monitor
                next
                edit 48
                    set category 28
                    set action monitor
                next
                edit 49
                    set category 58
                    set action monitor
                next
                edit 50
                    set category 20
                    set action monitor
                next
                edit 51
                    set category 40
                    set action monitor
                next
                edit 52
                    set category 33
                    set action monitor
                next
                edit 53
                    set category 69
                    set action monitor
                next
                edit 54
                    set category 34
                    set action monitor
                next
                edit 55
                    set category 55
                    set action monitor
                next
                edit 56
                    set category 35
                    set action monitor
                next
                edit 57
                    set category 36
                    set action monitor
                next
                edit 58
                    set category 70
                    set action monitor
                next
                edit 59
                    set category 87
                    set action monitor
                next
                edit 60
                    set category 48
                    set action monitor
                next
                edit 61
                    set category 80
                    set action monitor
                next
                edit 62
                    set category 38
                    set action monitor
                next
                edit 63
                    set category 78
                    set action monitor
                next
                edit 64
                    set category 39
                    set action monitor
                next
                edit 65
                    set category 79
                    set action monitor
                next
                edit 66
                    set category 42
                    set action monitor
                next
                edit 67
                    set category 37
                    set action monitor
                next
                edit 68
                    set category 44
                    set action monitor
                next
                edit 69
                    set category 46
                    set action monitor
                next
                edit 70
                    set category 47
                    set action monitor
                next
                edit 71
                    set category 68
                    set action monitor
                next
                edit 72
                    set category 23
                    set action monitor
                next
                edit 73
                    set category 53
                    set action monitor
                next
                edit 74
                    set category 49
                    set action monitor
                next
                edit 75
                    set category 92
                    set action monitor
                next
                edit 76
                    set category 31
                    set action monitor
                next
                edit 77
                    set category 43
                    set action monitor
                next
                edit 78
                    set category 51
                    set action monitor
                next
                edit 79
                    set category 52
                    set action monitor
                next
                edit 80
                    set category 50
                    set action monitor
                next
                edit 81
                    set category 95
                    set action monitor
                next
                edit 82
                    set category 93
                    set action monitor
                next
                edit 83
                    set category 41
                    set action monitor
                next
                edit 84
                    set category 81
                    set action monitor
                next
                edit 85
                    set category 94
                    set action monitor
                next
                edit 86
                    set category 56
                    set action monitor
                next
                edit 87
                    set category 84
                    set action monitor
                next
                edit 88
                    set category 90
                    set action monitor
                next
                edit 89
                    set category 91
                    set action monitor
                next
            end
        end
    next
end

###########################
# WebFilter Settings URL Filter Proxy
###########################
config webfilter urlfilter
edit 1
set name "URLList_bube_proxy_v1.4"
set comment "URL Filter default profile webf_bube"
config entries
edit 1
set url "*.apple.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 2
set url "*.itunes.apple.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 3
set url "*.phobos.apple.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 4
set url "*.apple.com.edgesuite.net"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 5
set url "*.windowsupdate.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 6
set url "*.download.windowsupdate.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 7
set url "*.stats.update.microsoft.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 8
set url "*.msftncsi.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 9
set url "*.microsoft.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 10
set url "*.dropbox.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 11
set url "*.hooc.me"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 12
set url "*.speedtest.net"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 13
set url "*.speedtest.yetnet.ch"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 14
set url "91.201.56.200"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
end
next
end


###########################
# WebFilter Settings URL Filter flow
###########################

config webfilter urlfilter
edit 2
set name "URLList_bube_flow_v1.4"
set comment "URL Filter default profile webf_bube"
config entries
edit 1
set url "*.apple.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 2
set url "*.itunes.apple.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 3
set url "*.phobos.apple.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 4
set url "*.apple.com.edgesuite.net"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 5
set url "*.windowsupdate.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 6
set url "*.download.windowsupdate.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 7
set url "*.stats.update.microsoft.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 8
set url "*.msftncsi.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 9
set url "*.microsoft.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 10
set url "*.dropbox.com"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 11
set url "*.hooc.me"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 12
set url "*.speedtest.net"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 13
set url "*.speedtest.yetnet.ch"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
edit 14
set url "91.201.56.200"
set type wildcard
set action exempt
set exempt av web-content activex-java-cookie dlp fortiguard range-block all
next
end
next
end

##################################################################
# Zuweisen des WebFilter Settings URL Filter zur Web Filter Policy
##################################################################

config webfilter profile
edit webf_bube_proxy_v1.4
config web
set urlfilter-table 1
end
next
end

config webfilter profile
edit webf_bube_flow_v1.4
config web
set urlfilter-table 2
end
next
end
